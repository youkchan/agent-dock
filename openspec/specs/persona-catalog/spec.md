# persona-catalog Specification

## Purpose
TBD - created by archiving change add-persona-quality-gates. Update Purpose after archive.
## Requirements
### Requirement: デフォルト品質ペルソナを提供すること
システムは品質観点を分離するため、少なくとも4つのデフォルトペルソナ（実装者、コードレビュワー、仕様確認者、テスト担当）を提供しなければならない（SHALL）。

#### Scenario: デフォルトペルソナが初期化される
- **WHEN** ペルソナ設定を明示せずにオーケストレーターを起動する
- **THEN** 4つのデフォルトペルソナが有効な状態で読み込まれる
- **AND** 各ペルソナは識別可能な `id` を持つ

### Requirement: プロジェクト定義による上書きと追加をサポートすること
システムはプロジェクト固有ペルソナ定義を読み込み、同名 `id` は完全上書き、非同名 `id` は追加として扱わなければならない（SHALL）。

#### Scenario: 同名 id は完全上書きされる
- **WHEN** プロジェクト定義にデフォルトと同じ `id` のペルソナが含まれる
- **THEN** デフォルト定義は採用されない
- **AND** プロジェクト側の定義が100%使用される

#### Scenario: 非同名 id は追加される
- **WHEN** プロジェクト定義にデフォルトに存在しない `id` が含まれる
- **THEN** そのペルソナは追加ペルソナとして有効化される

### Requirement: block 権限をペルソナ単位で制御できること
システムはペルソナ定義に `can_block` 属性を持ち、即停止権限をペルソナ単位で制御できなければならない（SHALL）。

#### Scenario: カスタムペルソナに block 権限を付与できる
- **WHEN** プロジェクト定義でカスタムペルソナに `can_block=true` を設定する
- **THEN** そのペルソナは blocker 指摘による即停止候補として扱われる

### Requirement: 不正なペルソナ定義を拒否すること
システムは必須項目欠落、型不一致、未知キーを含むペルソナ定義を受理してはならない（MUST NOT）。

#### Scenario: 未知キーを検出して失敗する
- **WHEN** ペルソナ定義に許可されていないキーが含まれる
- **THEN** 起動または読み込みは失敗する
- **AND** エラーには問題キー名が含まれる

