## コンテキスト
オーケストレーター基盤の実行制御（依存・承認・停止）は成立しているが、品質観点が Teammate ID に埋もれ、誰の観点の指摘か追跡しづらい。
この変更では、実行制御レイヤーに「観点の責務分離」を加え、仕様逸脱やテスト不足を早期に検知する。

## 目標
- デフォルトの品質観点を明示したペルソナ群を提供する。
- プロジェクト固有のペルソナを追加/上書きできる。
- 重大度に応じた一貫した制御（ログ、再確認、承認待ち、即停止）を導入する。
- ノイズ制御としてコメント上限を適用する。

## 非目標
- 自由会話の長文化
- 人格表現の演出強化
- ペルソナごとの独立 LLM セッション最適化（初期導入では対象外）

## 設計判断

### 1) ペルソナ定義モデル
最小モデルとして次の属性を持つ:
- `id`: 一意識別子
- `role`: 役割（implementer/reviewer/spec_guard/test_guard/custom）
- `focus`: 監視観点の短文定義
- `can_block`: 即停止権限の有無（既定 false）
- `enabled`: 有効/無効

`name` は初期導入では採用せず、必要になった時点で拡張する。

デフォルトでは次の4件を提供する:
- 実装者
- コードレビュワー
- 仕様確認者
- テスト担当

### 2) プロジェクト上書き規則
読み込み順は `default -> project` とする。
- 同名 `id` が project 側に存在する場合: デフォルトを使わず project 定義を完全採用（項目単位マージはしない）。
- 同名がない project `id`: 追加ペルソナとして採用。

このルールで「プロジェクトの意図を曖昧にしない」ことを優先する。

### 3) 重大度アクション
ペルソナ指摘は `info | warn | critical | blocker` を持つ。
アクションは次で固定する:
- `info`: ログのみ
- `warn`: 次ラウンド再確認キューへ追加
- `critical`: 対象タスクを `needs_approval` に遷移
- `blocker`: `can_block=true` ペルソナの指摘のみ即停止し `stop_reason=persona_blocker:<persona_id>`

`can_block=false` ペルソナが `blocker` を出した場合は `critical` と同等に扱う。

### 4) コメント上限
1イベントあたりの総コメント上限を既定2件とする。
上限を超える候補は、重大度優先（`blocker > critical > warn > info`）とし、同順位は安定ソート（`persona_id`, `task_id`）で決定的に切り捨てる。

### 5) 観測性（運用調整用）
導入後の閾値調整に必要な情報として、少なくとも以下を記録する:
- severity 別コメント件数
- `persona_blocker` 停止回数
- `warn` 再確認キュー残数

## リスクと緩和
- リスク: 指摘過多で進行停止が増える
  - 緩和: コメント上限、重大度優先、デフォルト `can_block=false`
- リスク: カスタム定義の誤記で想定外停止
  - 緩和: 定義スキーマ検証と未知キー拒否
- リスク: `critical` の過剰遷移で承認待ちが飽和
  - 緩和: タスク単位の重複遷移抑制と再確認間隔の制御

## 実装段階でのオープン項目
- ペルソナ定義ファイルの既定パス（CLI 引数と環境変数のどちらを主導にするか）
- `warn` の再確認対象を「同一 task/event」まで固定するか、ラウンド単位で抽象化するか
